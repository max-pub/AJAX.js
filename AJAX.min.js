AJAX={parse:function(text){try{return JSON.parse(text)}catch(e){return text}},QS:function(p){var esc=encodeURIComponent;var query=Object.keys(p).map(function(k){return esc(k)+"="+esc(p[k])}).join("&")},base:function(f){var xhr=new XMLHttpRequest;xhr.addEventListener("load",function(p){if(f)f(AJAX.parse(xhr.responseText))});return xhr},get:function(url,f){var xhr=AJAX.base(f);xhr.open("GET",url,true);xhr.send();return xhr},post:function(url,data,f){var xhr=AJAX.base(f);xhr.open("POST",url,true);data=AJAX.QS(data);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send(data);return xhr},put:function(url,data,f){var xhr=AJAX.base(f);xhr.open("PUT",url,true);data=AJAX.QS(data);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send(data);return xhr}};
